# Git同步一个项目到Gitee和GitHub指南

使用 Git 来管理你的项目与资源是一个非常高效的习惯。它不仅可以追踪你每一次的修改历史，让你随时可以回到任何一个版本，还可以通过远程仓库（如 Gitee 和 GitHub）在云端备份你的项目与资源，方便你在不同设备间同步。

本指南将带你完成以下目标：

1. **初始化**：将你的本地笔记文件夹置于 Git 的版本控制之下。
2. **连接双平台**：将这个本地文件夹同时与 Gitee 和 GitHub 上的两个远程仓库建立连接。
3. **一次性推送**：实现日常更新时，使用一条命令就将笔记同步推送到 Gitee 和 GitHub 两个仓库。

## 第一步：初始化本地文件夹，让 Git 开始管理它

1. **打开终端或命令行工具**：

   - 在 Windows 上，你可以使用 `Git Bash`（推荐）、`CMD` 或 `PowerShell`。
   - 在 macOS 或 Linux 上，使用 `Terminal`。

2. **进入你的笔记文件夹**： 使用 `cd` 命令切换到你的笔记文件夹所在的路径。

   ```cmd
   cd 你的文件夹路径
   ```

3. **执行初始化命令**：

   ```cmd
   git init
   ```

4. **添加所有文件到暂存区并提交**：

   ```cmd
   git add .
   git commit -m "Initial commit: My notes collection"
   ```

## 第二步：创建远程仓库

接下来，我们需要在 Gitee 和 GitHub 上分别创建一个空的仓库。

1. 登录你的 Gitee 账号，新建一个仓库。
2. 登录你的 GitHub 账号，也新建一个空的仓库。

**重要提示**：创建时**不要**勾选任何“初始化仓库”相关的选项（如创建 `README.md`、`.gitignore` 等），我们要的是一个完全空的仓库。创建完成后，分别复制两个仓库的 SSH 格式 URL 地址备用。



## 第三步：配置 `origin` 实现一次性推送

这是最核心的一步，我们采用最明确、无歧义的方式进行配置。

1. **设置 Gitee 为主要远程仓库** 这个命令会创建一个名为 `origin` 的远程别名。默认情况下，它的**拉取（fetch）和推送（push）地址都会指向 Gitee**。

   ```cmd
   git remote add origin git@gitee.com:你的Gitee用户名/你的仓库名.git
   ```

2. **明确设置第一个推送地址** 

   为了避免歧义，我们现在显式地告诉 Git，`origin` 的推送目标**首先**是 Gitee。

   这个命令会**覆盖**掉上一步中默认的推送设置，为后续添加更多推送地址做准备。

   ```cmd
   git remote set-url --push origin git@gitee.com:你的Gitee用户名/你的仓库名.git
   ```

3. **添加第二个推送地址** 

   现在，我们使用 `--add` 参数，将 GitHub **添加**到推送列表中。

   ```cmd
   git remote set-url --push --add origin git@github.com:你的GitHub用户名/你的仓库名.git
   ```

4. **验证最终配置** 运行 `git remote -v` 来检查最终的配置。

   ```cmd
   git remote -v
   ```

   你应该会看到下面这样**精确**的结果，这表示配置完全正确：

   ```cmd
   origin   git@gitee.com:你的Gitee用户名/你的仓库名.git (fetch)
   origin   git@gitee.com:你的Gitee用户名/你的仓库名.git (push)
   origin   git@github.com:你的GitHub用户名/你的仓库名.git (push)
   ```

   这个结果清晰地表明：拉取（fetch）只从 Gitee 进行，而推送（push）会同时发送到 Gitee 和 GitHub。



## 第四步：日常更新与推送流程

### 流程

现在，你的日常更新流程变得极其简单。

1. 修改或新增你的项目。

2. 添加更改到暂存区： `git add .`

3. 提交你的更改： `git commit -m "更新日志"`

4. **一次性推送到 Gitee 和 GitHub**：

   ```cmd
   git push origin main
   ```



### 关于 `git push` 和 `git push origin main`

你可能会有疑问，为什么教程里用的是 `git push origin main`，而不是更简洁的 `git push`？

- **`git push origin main`** 是最完整的命令，它清晰地告诉 Git：我要把本地的 `main` 分支，推送到名为 `origin` 的远程仓库去。这是一种非常明确、不会出错的好习惯。
- **`git push`** 是一个简写。要让它正常工作，你需要先为你当前的分支设置一个“上游”（upstream）分支。

**如何设置并使用简写？**

在你**第一次**推送这个分支时，使用 `-u` 参数：

```cmd
git push -u origin main
```

这个 `-u` 参数会建立一个连接，告诉 Git：“请记住，本地的 `main` 分支以后就默认推送到 `origin` 的 `main` 分支。”

设置好这一次之后，未来在这个分支上的所有推送，你就可以直接使用简写了：

```cmd
git push
```

这会让日常操作更快捷。你可以根据自己的习惯选择使用哪一种。



## 附录

### 附录A：更换新电脑后的操作

当你更换一台新的电脑时，多仓库推送的配置**不会**自动同步，需要重新设置。

1. **克隆你的主仓库**：

   ```cmd
   git clone git@gitee.com:你的Gitee用户名/你的仓库名.git
   cd 你的仓库名
   ```

2. **重新配置多仓库推送**： 在新电脑的仓库文件夹中，完整地重复一遍**第三步**的操作即可。

   ```cmd
   # 1. clone 操作会自动创建 origin，无需再次 add
   # 2. 明确设置第一个推送地址为 Gitee
   git remote set-url --push origin git@gitee.com:你的Gitee用户名/你的仓库名.git
   # 3. 添加第二个推送地址为 GitHub
   git remote set-url --push --add origin git@github.com:你的GitHub用户名/你的仓库名.git
   ```

   完成后，你的新电脑就配置好了。



### 附录B：常见问题排查

**问题：执行 `git push -u origin main` 时报错 `src refspec main does not match any`**

这是一个非常常见的错误，通常有两个原因：

**原因1：你还没有进行任何提交（commit）。** 在一个全新的仓库里，`main` 分支在你创建第一个 commit 之后才会被真正创建。

- **解决方案**：确保你已经添加了文件并执行了 commit 操作。

  ```cmd
  git add .
  git commit -m "Initial commit"
  # 然后再重新推送
  git push -u origin main
  ```

**原因2：你的本地默认分支名叫 `master` 而不是 `main`。** 一些旧版本的 Git 会默认创建 `master` 分支。你可以通过 `commit` 后的提示信息来确认分支名，例如 `[master (root-commit) ...]`。

- **解决方案（推荐）**：将本地的 `master` 分支重命名为 `main`，以和当前主流保持一致。

  ```cmd
  # 将 master 分支重命名为 main
  git branch -M main
  # 现在再推送就没问题了
  git push -u origin main
  ```

- **解决方案（备选）**：你也可以选择直接推送 `master` 分支。

  ```cmd
  git push -u origin master
  ```



## 问题: Git SSH 连接 GitHub 超时(端口 22 被封锁)

### 问题现象

- 当使用 SSH 协议的远程地址 (`git@github.com:...`) 执行 `git push`, `git pull` 等操作时，出现连接超时错误：

  ```cmd
  ssh: connect to host github.com port 22: Connection timed out
  fatal: Could not read from remote repository.
  ```

  

### 根本原因

- 这个错误**不是本地端口被占用**，而是 SSH 默认使用的 **22 端口** 在当前网络环境下被防火墙（例如公司防火墙或 GFW）拦截，导致请求无法到达 GitHub 服务器。

- 相比之下，用于网页浏览的 **443 端口** (HTTPS) 几乎总是开放的。因此，最佳解决方案就是让我们的 SSH 流量巧妙地“伪装”起来，从开放的 443 端口通过。



### 解决方案：修改 SSH 客户端配置

- 我们可以通过一个本地配置文件，告诉本机上所有的 SSH 工具（包括 Git），在连接 `github.com` 时，自动切换到 443 端口。这是一个**一劳永逸**的方法，配置一次后，所有项目都能生效。

#### 1. 找到或创建 `config` 文件

- 此配置文件的文件名为 `config` (没有后缀名)。
- 它位于你个人用户文件夹下的 `.ssh` 目录中。
- **Windows 路径:** 在文件资源管理器的地址栏输入 `%USERPROFILE%\.ssh` 即可直达。完整路径类似 `C:\Users\你的用户名\.ssh\config`。
- **macOS / Linux 路径:** `~/.ssh/config`

> **提示**: 如果 `.ssh` 文件夹或 `config` 文件不存在，请手动创建它们。



#### 2. 编辑 `config` 文件

用记事本或任何代码编辑器打开 `config` 文件，将以下内容完整地复制粘贴进去并保存：

```
Host github.com
  Hostname ssh.github.com
  Port 443
  User git
```



#### 3. 配置含义解释

- `Host github.com`: 定义了一个规则块，仅当 SSH 连接的目标是 `github.com` 时生效。
- `Hostname ssh.github.com`: 实际连接的服务器地址。这是 GitHub 官方提供的、专门在 443 端口上接收 SSH 连接的服务器。
- `Port 443`: 指定连接端口为 443，而不是默认的 22。
- `User git`: 指定登录用户名为 `git`，这是 GitHub SSH 认证的固定用法。



### 验证配置是否成功

- 完成上述配置后，打开命令行工具，运行以下命令进行测试：

  ```cmd
  ssh -T git@github.com
  ```

- 如果配置成功，你会看到 GitHub 的欢迎信息，其中包含你的用户名：

  ```cmd
  Hi YourUsername! You've successfully authenticated, but GitHub does not provide shell access.
  ```

- 看到这条信息，就代表问题已完美解决。现在你可以正常使用 `git push` 等所有 SSH 命令了

  ```CMD
  Hi YourUsername! You've successfully authenticated, but GitHub does not provide shell access.
  ```

  